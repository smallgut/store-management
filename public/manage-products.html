<div class="container mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4" id="manage-products-title">Manage Products</h1>
  <div id="loading" class="hidden text-blue-500">Loading...</div>
  <div id="message" class="text-green-500 mb-2"></div>
  <div id="error" class="text-red-500 mb-2"></div>

  <div class="mb-4">
    <h2 class="text-xl font-semibold mb-2" id="add-product-title">Add New Product</h2>
    <form onsubmit="event.preventDefault(); addProduct({
      barcode: document.getElementById('barcode').value.trim(),
      name: document.getElementById('name').value.trim(),
      stock_in_qty: parseInt(document.getElementById('stock-in-qty').value) || 0,
      stock_in_price: parseFloat(document.getElementById('stock-in-price').value) || 0,
      vendor_id: parseInt(document.getElementById('vendor-id').value) || null
    })">
      <input id="barcode" type="text" placeholder="Barcode" class="border p-2 rounded mr-2" required>
      <input id="name" type="text" placeholder="Name" class="border p-2 rounded mr-2" required>
      <input id="stock-in-qty" type="number" placeholder="Initial Stock" class="border p-2 rounded mr-2" min="0">
      <input id="stock-in-price" type="number" step="0.01" placeholder="Buy-in Price" class="border p-2 rounded mr-2" min="0">
      <select id="vendor-id" class="border p-2 rounded mr-2">
        <option value="">Select Vendor (Optional)</option>
      </select>
      <button type="submit" class="bg-blue-500 text-white p-2 rounded hover:bg-blue-600" id="add-product-btn">Add Product</button>
    </form>
  </div>

  <table id="products" class="w-full border-collapse border">
    <thead>
      <tr class="bg-gray-200">
        <th class="border p-2"><a href="#" onclick="sortProducts('name')">Name</a></th>
        <th class="border p-2">Barcode</th>
        <th class="border p-2"><a href="#" onclick="sortProducts('price')">Price</a></th>
        <th class="border p-2"><a href="#" onclick="sortProducts('stock')">Stock</a></th>
        <th class="border p-2">Vendor</th>
        <th class="border p-2">Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
  // Update form and page language
  function updatePageLanguage() {
    const isChinese = langBody.classList.contains('lang-zh');
    document.getElementById('manage-products-title').textContent = isChinese ? '管理產品' : 'Manage Products';
    document.getElementById('add-product-title').textContent = isChinese ? '添加新產品' : 'Add New Product';
    document.getElementById('barcode').placeholder = isChinese ? '條碼' : 'Barcode';
    document.getElementById('name').placeholder = isChinese ? '名稱' : 'Name';
    document.getElementById('stock-in-qty').placeholder = isChinese ? '初始庫存' : 'Initial Stock';
    document.getElementById('stock-in-price').placeholder = isChinese ? '進貨價' : 'Buy-in Price';
    document.getElementById('add-product-btn').textContent = isChinese ? '添加產品' : 'Add Product';
  }

  // Load products and vendors on page load
  document.addEventListener('DOMContentLoaded', () => {
    loadProducts();
    loadVendors();
  });
</script>
