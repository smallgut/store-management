<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Supabase App</title>
</head>
<body>
  <h1>Supabase Test App</h1>
  <button onclick="addProduct({ barcode: '123456789', name: 'Test Item', price: 10.99, stock: 50 })">Add Product</button>
  <div id="products"></div>

  <!-- Load Supabase SDK from jsDelivr -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script>
    // Initialize Supabase client
    if (typeof supabase === 'undefined') {
      console.error('Supabase SDK not loaded');
      throw new Error('Supabase SDK not loaded');
    }

    const { createClient } = supabase;
    window.supabaseClient = createClient(
      'https://aouduygmcspiqauhrabx.supabase.co', // Replace with your Supabase Project URL (e.g., https://abc123.supabase.co)
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFvdWR1eWdtY3NwaXFhdWhyYWJ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUyNTM5MzAsImV4cCI6MjA2MDgyOTkzMH0.s8WMvYdE9csSb1xb6jv84aiFBBU_LpDi1aserTQDg-k' // Replace with your Supabase Anonymous Key (e.g., eyJhb...)
    );
    console.log('Supabase Client Initialized:', window.supabaseClient);

    // Test Supabase connection
    async function testSupabase() {
      if (!window.supabaseClient) {
        console.error('Supabase client not initialized');
        return;
      }
      console.log('Supabase client is ready:', window.supabaseClient);
    }

    // Load products
    async function loadProducts() {
      if (!window.supabaseClient) {
        console.error('Supabase client not initialized');
        return;
      }
      try {
        const { data, error } = await window.supabaseClient.from('products').select('*');
        if (error) throw error;
        console.log('Products:', data);
        // Display products in the UI
        const productsDiv = document.getElementById('products');
        productsDiv.innerHTML = data.map(p => `<p>${p.name}: $${p.price} (Stock: ${p.stock})</p>`).join('');
      } catch (error) {
        console.error('Error loading products:', error.message);
      }
    }

    // Load sales (placeholder, adjust table name as needed)
    async function loadSales() {
      if (!window.supabaseClient) {
        console.error('Supabase client not initialized');
        return;
      }
      try {
        const { data, error } = await window.supabaseClient.from('sales').select('*');
        if (error) throw error;
        console.log('Sales:', data);
      } catch (error) {
        console.error('Error loading sales:', error.message);
      }
    }

    // Load vendors (placeholder, adjust table name as needed)
    async function loadVendors() {
      if (!window.supabaseClient) {
        console.error('Supabase client not initialized');
        return;
      }
      try {
        const { data, error } = await window.supabaseClient.from('vendors').select('*');
        if (error) throw error;
        console.log('Vendors:', data);
      } catch (error) {
        console.error('Error loading vendors:', error.message);
      }
    }

    // Add product
    async function addProduct(product) {
      if (!window.supabaseClient) {
        console.error('Supabase client not initialized');
        return;
      }
      console.log('Adding product:', product);
      try {
        const { data, error } = await window.supabaseClient
          .from('products')
          .insert([product]);
        if (error) throw error;
        console.log('Product added:', data);
        // Refresh products list
        loadProducts();
      } catch (error) {
        console.error('Error adding product:', error.message);
      }
    }

    // Run on page load
    document.addEventListener('DOMContentLoaded', () => {
      testSupabase();
      loadProducts();
      loadSales();
      loadVendors();
    });
  </script>
</body>
</html>
