<!DOCTYPE html>
<html lang="en" id="lang-body" class="lang-en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-lang-key="nav-home">Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="common.js"></script>
</head>
<body class="bg-gray-100 p-4">
  <nav class="bg-blue-500 p-4 text-white flex justify-between items-center">
  <ul class="flex space-x-4">
    <li><a href="index.html" data-lang-key="nav-home">Home</a></li>
    <li><a href="login.html" data-lang-key="nav-login">Login</a></li>
    <li data-role="admin,manager">  <a href="analytics.html">Analytics</a></li>
    <li data-role="admin,manager">  <a href="products.html">Manage Products</a></li>
    <li data-role="admin,manager">  <a href="vendors.html">Manage Vendors</a></li>
    <li><a href="customer-sales.html" data-lang-key="nav-record-customer-sales">Record Customer Sales</a></li>
    <li><a href="vendor-loan-record.html" data-lang-key="nav-vendor-loan-record">Vendor Loan Record</a></li>
    <li><a href="product-catalog.html" data-lang-key="nav-product-catalog">Product Catalog</a></li>
    
  </ul>
    <li><a href="index_zh.html">ä¸­æ–‡ç‰ˆ</a></li>
  <!-- ğŸ”’ Logout button -->
  <button id="logout-btn" class="bg-red-500 px-3 py-1 rounded hover:bg-red-600">Logout</button>
</nav>

  <h1 data-lang-key="nav-home" class="text-2xl font-bold mb-4">Home</h1>
  <div id="error" class="text-red-500 mb-4 font-bold text-lg"></div>
  <div id="message" class="text-green-500 mb-4 font-bold text-lg"></div>
  <div id="loading" class="text-blue-500 mb-4" style="display: none;">Loading...</div>

  <div class="bg-white p-6 rounded-xl shadow text-gray-700">
    <p class="text-lg">ğŸ‘‹ Welcome to the POS system homepageï¼</p>
    <p class="mt-2">Please use the navigation menu above to access various functions, such as "Manage Products", "Analysis", "Supplier Management" or "Customer Sales Records".</p>
  </div>

  <div class="mt-6 bg-white p-4 rounded-xl shadow text-sm text-gray-600">
    <p>ğŸ“… Today isï¼š<span id="today-date"></span></p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      console.log("ğŸ  åˆå§‹åŒ–é¦–é ...");

      const supabase = await ensureSupabaseClient();

      // ğŸ”’ ç™»å…¥é©—è­‰
      const { data: { session } } = await supabase.auth.getSession();
      if (!session) {
        alert("è«‹å…ˆç™»å…¥ç³»çµ±ã€‚ Please log in to the system first.");
        window.location.href = "login_zh.html";
        return;
      }
const role = await getUserRole();
applyRoleRestrictions(role);
      // ğŸ”‘ ç™»å‡ºæŒ‰éˆ•
      const logoutBtn = document.getElementById("logout-btn");
      if (logoutBtn) {
        logoutBtn.addEventListener("click", async () => {
          await supabase.auth.signOut();
          alert("æ‚¨å·²æˆåŠŸç™»å‡ºç³»çµ±ã€‚");
          window.location.href = "login_zh.html";
        });
      }

      // âœ… é¡¯ç¤ºä»Šæ—¥æ—¥æœŸ
      const today = new Date().toLocaleDateString("EN", {
        year: "numeric",
        month: "long",
        day: "numeric",
        weekday: "long"
      });
      document.getElementById("today-date").textContent = today;

      // âœ¨ é é¢æ·¡å…¥æ•ˆæœ
      setTimeout(() => document.body.style.opacity = 1, 100);
    });
  </script>
</body>
</html>
