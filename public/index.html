<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    select { width: 300px; padding: 5px; }
    option { padding: 5px; }
  </style>
</head>
<body>
  <label for="productSelect">Select Product (or input barcode):</label>
  <select id="productSelect" onchange="updateStock()">
    <option value="">-- Select a product --</option>
  </select>
  <p>Selected On-Hand Stock: <span id="stockQty">N/A</span></p>

  <script>
    async function fetchProducts() {
      const response = await axios.get('/api/products'); // Replace with your API endpoint
      const products = response.data;
      const select = document.getElementById('productSelect');
      products.forEach(product => {
        const option = document.createElement('option');
        option.value = product.barcode;
        option.text = `${product.name} (Barcode: ${product.barcode}, Batch: ${product.batch_no}, Stock: ${product.on_hand_stock})`;
        select.appendChild(option);
      });
    }

    function updateStock() {
      const select = document.getElementById('productSelect');
      const selectedOption = select.options[select.selectedIndex].text;
      const stockMatch = selectedOption.match(/Stock: (\d+)/);
      document.getElementById('stockQty').textContent = stockMatch ? stockMatch[1] : 'N/A';
    }

    // Fetch products on page load
    window.onload = fetchProducts;
  </script>
</body>
</html>
